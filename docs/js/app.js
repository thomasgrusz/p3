import{Resources}from"./resources.js";import{ctx}from"./engine.js";var Enemy=function(){this.sprite="images/enemy-bug.png",this.minXCoord=-100,this.maxXCoord=505,this.yCoords=[-23,60,143,226,309,392],this.width=101};Enemy.prototype.reset=function(){this.x=this.minXCoord,this.y=this.yCoords[app.random_number(1,3)],this.speed=app.random_number(100,400),this.collisionFlag=!1},Enemy.prototype.update=function(t){this.x<this.maxXCoord?this.x=this.x+this.speed*t:this.reset(),!0===this.collisionFlag&&(player.x=player.xOrigin,player.y=player.yOrigin,player.lives--,this.reset())},Enemy.prototype.render=function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)};var Player=function(){this.xCoords=[1,101,201,301,401],this.yCoords=[-11,72,155,238,321,404],this.xOrigin=this.xCoords[2],this.yOrigin=this.yCoords[5],this.leftBorder=this.xCoords[0],this.rightBorder=this.xCoords[4],this.upperBorder=this.yCoords[0],this.lowerBorder=this.yCoords[5],this.waterBorder=72,this.width=101,this.emptyPixelOffset=17,this.characters=["images/char-boy.png","images/char-cat-girl.png","images/char-horn-girl.png","images/char-pink-girl.png","images/char-princess-girl.png"],this.characterSelectedFlag=!1,this.startScreenDisplay=!0,this.startFirstGame=!1,this.selectorBoxXCoords=[40,130,215,310,400]};Player.prototype.reset=function(){this.x=this.xOrigin,this.y=this.yOrigin,this.lives=3,this.alive=!0,this.score=0,this.selectorBox=0,this.anotherGameFlag=!1,this.gameWon=!1},Player.prototype.update=function(){this.lives<=0&&(this.alive=!1),this.y<this.waterBorder&&(this.x=this.xOrigin,this.y=this.yOrigin,this.score+=10)},Player.prototype.render=function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y);for(var t=1;t<=this.lives;t++)ctx.drawImage(Resources.get("images/Heart.png"),40*t-30,525)},Player.prototype.collisionDetect=function(t){for(var e=0;e<=5;e++)t.y===t.yCoords[e]&&this.y===this.yCoords[e]&&(t.x>this.x&&this.x+this.width-this.emptyPixelOffset>t.x&&(t.collisionFlag=!0),this.x>t.x&&t.x+t.width>this.x+this.emptyPixelOffset&&(t.collisionFlag=!0))},Player.prototype.renderScore=function(){app.displayPanel(290,545,190,20,"lightgreen"),ctx.font="32pt Lobster",ctx.fillStyle="green",ctx.fillText("Score: ",290,580),ctx.fillText(player.score,400,580)},Player.prototype.handleInput=function(t){if(!0===this.startScreenDisplay&&"return"===t&&(this.startFirstGame=!0),!1===this.characterSelectedFlag&&!1===this.startScreenDisplay&&("left"===t&&this.selectorBox>0?this.selectorBox=this.selectorBox-1:"left"===t&&0===this.selectorBox&&(this.selectorBox=4),"right"===t&&this.selectorBox<4?this.selectorBox=this.selectorBox+1:"right"===t&&4===this.selectorBox&&(this.selectorBox=0),"return"===t&&(this.characterSelectedFlag=!0,this.sprite=this.characters[this.selectorBox])),"return"!==t||!1!==this.alive&&!0!==this.gameWon||(this.anotherGameFlag=!0),"space"===t&&!0===this.characterSelectedFlag&&!0===this.alive&&!1===this.gameWon&&(app.pauseFlag=!app.pauseFlag),!0===this.characterSelectedFlag&&!1===app.pauseFlag){var e=app.isRock(this.xCoords.indexOf(this.x),this.yCoords.indexOf(this.y));"left"===t&&this.x>this.leftBorder&&!e[0]?this.x=this.xCoords[this.xCoords.indexOf(this.x)-1]:"right"===t&&this.x<this.rightBorder&&!e[1]?this.x=this.xCoords[this.xCoords.indexOf(this.x)+1]:"down"===t&&this.y<this.lowerBorder&&!e[2]?this.y=this.yCoords[this.yCoords.indexOf(this.y)+1]:"up"===t&&this.y>this.upperBorder&&!e[3]&&(this.y=this.yCoords[this.yCoords.indexOf(this.y)-1])}};var Collectible=function(){this.xCoords=[27,127,227,327,427],this.yCoords=[34,117,200,283,366,449],this.width=50,this.height=85,this.collectibles=["images/Gem Blue.png","images/Gem Green.png","images/Gem Orange.png"]};Collectible.prototype.reset=function(){do{this.x=this.xCoords[app.random_number(0,4)],this.y=this.yCoords[app.random_number(1,5)]}while(227===this.x&&449===this.y||app.overlap(app.allCollectibles,app.allCollectibles.indexOf(this)));this.randomCollectible=this.collectibles[app.random_number(0,2)],this.collisionFlag=!1},Collectible.prototype.update=function(){!0===this.collisionFlag&&(this.collisionFlag=!1,this.x=-100,this.randomCollectible===this.collectibles[0]&&(player.score+=80),this.randomCollectible===this.collectibles[1]&&(player.score+=50),this.randomCollectible===this.collectibles[2]&&(player.score+=30))},Collectible.prototype.render=function(){ctx.drawImage(Resources.get(this.randomCollectible),this.x,this.y,this.width,this.height)};var Rock=function(){this.width=101,this.xCoords=[1,101,201,301,401],this.yCoords=[-23,60,143,226,309,392],this.sprite="images/Rock.png"};Rock.prototype.reset=function(){do{this.x=this.xCoords[app.random_number(0,4)],this.y=this.yCoords[app.random_number(1,5)]}while(201===this.x&&392===this.y||app.overlap(app.allRocks,app.allRocks.indexOf(this))||app.isGem(app.allRocks.indexOf(this)))},Rock.prototype.render=function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)};var Timer=function(){this.xPanel=10,this.yPanel=50,this.width=190,this.height=20,this.xText=10,this.yText=85,this.xTime=125,this.yTime=85};Timer.prototype.reset=function(){this.time=60,clearInterval(timer.myTimer),this.myTimer=setInterval(timer.update,1e3)},Timer.prototype.update=function(){player.characterSelectedFlag&&player.alive&&!1===app.pauseFlag&&timer.time>0&&timer.time--,timer.time<=0&&player.score<200&&(player.alive=!1),player.score>=200&&(player.gameWon=!0,clearInterval(timer.myTimer))},Timer.prototype.render=function(){app.displayPanel(this.xPanel,this.yPanel,this.width,this.height,"lightblue"),ctx.font="32pt Lobster",ctx.fillStyle="blue",ctx.fillText("Timer: ",this.xText,this.yText),ctx.fillText(timer.time,this.xTime,this.yTime)};export const app={};app.pauseFlag,app.allEnemies=[],app.allCollectibles=[],app.allRocks=[],app.random_number=function(t,e){return 0===t?Math.floor(Math.random()*(e+1)):t+Math.floor(Math.random()*e)},app.displayPanel=function(t,e,i,s,r){ctx.fillStyle=r,ctx.beginPath(),ctx.moveTo(t,e),ctx.lineTo(t+i,e),ctx.quadraticCurveTo(t+i+10,e,t+i+10,e+10),ctx.lineTo(t+i+10,e+s+10),ctx.quadraticCurveTo(t+i+10,e+s+20,t+i,e+s+20),ctx.lineTo(t,e+s+20),ctx.quadraticCurveTo(t-10,e+s+20,t-10,e+s+10),ctx.lineTo(t-10,e+10),ctx.quadraticCurveTo(t-10,e,t,e),ctx.fill()},app.displayPanelOutline=function(t,e,i,s,r){ctx.lineWidth=5,ctx.strokeStyle=r,ctx.beginPath(),ctx.moveTo(t,e),ctx.lineTo(t+i,e),ctx.quadraticCurveTo(t+i+10,e,t+i+10,e+10),ctx.lineTo(t+i+10,e+s+10),ctx.quadraticCurveTo(t+i+10,e+s+20,t+i,e+s+20),ctx.lineTo(t,e+s+20),ctx.quadraticCurveTo(t-10,e+s+20,t-10,e+s+10),ctx.lineTo(t-10,e+10),ctx.quadraticCurveTo(t-10,e,t,e),ctx.stroke()},app.isRock=function(t,e){var i=[!1,!1,!1,!1];return app.allRocks.forEach((function(s){t-1===s.xCoords.indexOf(s.x)&&e===s.yCoords.indexOf(s.y)&&(i[0]=!0),t+1===s.xCoords.indexOf(s.x)&&e===s.yCoords.indexOf(s.y)&&(i[1]=!0),t===s.xCoords.indexOf(s.x)&&e+1===s.yCoords.indexOf(s.y)&&(i[2]=!0),t===s.xCoords.indexOf(s.x)&&e-1===s.yCoords.indexOf(s.y)&&(i[3]=!0)})),i},app.overlap=function(t,e){if(e>0)for(var i=0;i<e;i++)if(t[e].x===t[i].x&&t[e].y===t[i].y)return!0;return!1},app.isGem=function(t){var e=!1;return app.allCollectibles.forEach((function(i){app.allRocks[t].xCoords.indexOf(app.allRocks[t].x)===i.xCoords.indexOf(i.x)&&app.allRocks[t].yCoords.indexOf(app.allRocks[t].y)===i.yCoords.indexOf(i.y)&&(e=!0)})),e};for(var i=1;i<=3;i++)app.allEnemies.push(new Enemy);for(i=1;i<=2;i++)app.allCollectibles.push(new Collectible);for(i=1;i<=2;i++)app.allRocks.push(new Rock);export const player=new Player;export const timer=new Timer;document.addEventListener("keydown",(function(t){player.handleInput({37:"left",38:"up",39:"right",40:"down",32:"space",13:"return"}[t.keyCode])}));